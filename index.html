<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Exercice Hiragana (rawData)</title>
  <style>
    body { font-family: sans-serif; background: #f2f2f2; padding: 20px; text-align: center; }
    .instruction { font-size: 1.2em; margin-bottom: 10px; }
    .grid-container { display: grid; gap: 5px; justify-content: center; margin-bottom: 5px; width: fit-content; margin-left: auto; margin-right: auto; }
    .romaji-box { height: 20px; font-size: 14px; line-height: 20px; text-align: center; width: 40px; }
    .box { width: 40px; height: 40px; border: 2px solid #333; font-size: 24px; line-height: 40px; background-color: white; text-align: center; }
    .box.correct { background-color: #c8f7c5; }
    .box.incorrect { background-color: #f9c0c0; }
    #buttons { margin-top: 10px; }
    #buttons button { margin: 5px; font-size: 20px; padding: 5px 10px; }
    #buttons button:disabled { background-color: #d0e6ff; color: #555; }
    .buttons { margin-top: 30px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    .buttons button {
      font-size: 24px;
      padding: 12px 24px;
      border-radius: 10px;
      background-color: #eeeeee;
      border: 2px solid #aaa;
    }
    .buttons button:hover {
      background-color: #d8eaff;
      cursor: pointer;
    }
    .feedback { font-weight: bold; font-size: 1.2em; margin-top: 15px; }
  </style>
</head>
<body>
  <div class="instruction" id="instruction"></div>
  <div class="grid-container" id="romaji-container"></div>
  <div class="grid-container" id="phrase-container"></div>
  <div id="buttons"></div>
  <div class="buttons">
    <button id="checkButton" onclick="checkAnswer()" disabled>V√©rifier</button>
    <button onclick="clearBoxes()">RAZ</button>
    <button onclick="undoLast()">‚Üê</button>
    <button id="hintButton" onmousedown="showHint()" onmouseup="hideHint()" ontouchstart="showHint()" ontouchend="hideHint()">üí°</button>
    <button onclick="nextPhrase()">Phrase suivante</button>
  </div>
  <div class="feedback" id="feedback"></div>
  <div class="feedback">Aides utilis√©es : <span id="hintCount">0</span></div>

  <script>
    const rawData = `„Åì „Çå „ÅØ „Å≠ „Åì „Åß „Åô	Kore wa neko desu	Ceci est un chat.
„Åù „Åì „ÅØ „Åå „Å£ „Åì „ÅÜ „Åß „Åô	Soko wa gakkou desu	L√†, c‚Äôest une √©cole.
„ÅÇ „Åù „Åì „Å´ „ÅÑ „Å¨ „Åå „ÅÑ „Åæ „Åô	Asoko ni inu ga imasu	L√†-bas, il y a un chien.
„Åä „ÅØ „Çà „ÅÜ „Åî „Åñ „ÅÑ „Åæ „Åô	Ohayou gozaimasu	Bonjour (le matin).
„Åì „Çì „Å´ „Å° „ÅØ	Konnichiwa	Bonjour (apr√®s-midi).
„Åì „Çå „ÅØ „Åò „Åó „Çá „Åß „Åô	Kore wa jisho desu	Ceci est un dictionnaire.
„ÅÇ „Çå „ÅØ „ÅÑ „Åô „Åß „Åô	Are wa isu desu	Cela l√†-bas est une chaise.
„Çè „Åü „Åó „ÅØ „Åå „Åè „Åõ „ÅÑ „Åß „Åô	Watashi wa gakusei desu	Je suis √©tudiant(e).
„ÅÇ „ÅÆ „Å≤ „Å® „ÅØ „Åõ „Çì „Åõ „ÅÑ „Åß „Åô	Ano hito wa sensei desu	Cette personne est un professeur.
„Åß „Çì „Åó „ÇÑ „ÅØ „Åì „Åì „Åß „Åô	Densha wa koko desu	Le train est ici.
„ÅÑ „Åæ „ÅØ „Åò „ÇÖ „ÅÜ „Å´ „Åò „Åß „Åô	Ima wa juu ni ji desu	Il est midi.
„Å´ „Åª „Çì „Åî „Çí „Åπ „Çì „Åç „Çá „ÅÜ „Åó „Åæ „Åô	Nihongo o benkyou shimasu	J'√©tudie le japonais.
„Åô „Åø „Åæ „Åõ „Çì	Sumimasen	Excusez-moi.
„Åî „ÇÅ „Çì „Å™ „Åï „ÅÑ	Gomen nasai	Je suis d√©sol√©(e).
„ÅÑ „Åü „Å† „Åç „Åæ „Åô	Itadakimasu	Bon app√©tit (avant de manger).
„Åî „Å° „Åù „ÅÜ „Åï „Åæ	Gochisousama	Merci pour ce repas.
„ÅÑ „Å£ „Å¶ „Åç „Åæ „Åô	Ittekimasu	Je pars (√† plus tard).
„Åü „Å† „ÅÑ „Åæ	Tadaima	Je suis rentr√©(e).
„Åä „Åã „Åà „Çä „Å™ „Åï „ÅÑ	Okaerinasai	Bon retour.
„ÇÑ „Åô „Åø „Åæ „Åô	Yasumimasu	Je me repose / Je m‚Äôabsente.
„Çè „Åã „Çä „Åæ „Åõ „Çì	Wakarimasen	Je ne comprends pas.
„ÇÇ „ÅÜ „ÅÑ „Å° „Å© „Åä „Å≠ „Åå „ÅÑ „Åó „Åæ „Åô	Mou ichido onegaishimasu	Encore une fois s'il vous pla√Æt.
„ÇÜ „Å£ „Åè „Çä „Åä „Å≠ „Åå „ÅÑ „Åó „Åæ „Åô	Yukkuri onegaishimasu	Plus lentement s'il vous pla√Æt.
„Å™ „Çì „Åß „Åô „Åã	Nan desu ka	Qu‚Äôest-ce que c‚Äôest ?
„Å® „ÅÑ „Çå „ÅØ „Å© „Åì „Åß „Åô „Åã	Toire wa doko desu ka	O√π sont les toilettes ?
„ÅÑ „Åè „Çâ „Åß „Åô „Åã	Ikura desu ka	Combien √ßa co√ªte ?
„Åü „Åã „ÅÑ „Åß „Åô „Å≠	Takai desu ne	C‚Äôest cher, n‚Äôest-ce pas ?
„ÇÑ „Åô „ÅÑ „Åß „Åô	Yasui desu	C‚Äôest bon march√©.
„Åä „ÅÑ „Åó „ÅÑ „Åß „Åô	Oishii desu	C‚Äôest d√©licieux.
„Å§ „Åã „Çå „Åæ „Åó „Åü	Tsukaremashita	Je suis fatigu√©(e).
„ÅÇ „Çä „Åå „Å® „ÅÜ „Åî „Åñ „ÅÑ „Åæ „Åô	Arigatou gozaimasu	Merci beaucoup.
„Å© „ÅÜ „ÅÑ „Åü „Åó „Åæ „Åó „Å¶	Dou itashimashite	Je vous en prie.
„Çè „Åü „Åó „ÅÆ „Å™ „Åæ „Åà „ÅØ „Äú „Åß „Åô	Watashi no namae wa ~ desu	Je m'appelle ~.
„Å© „Åì „Åã „Çâ „Åç „Åæ „Åó „Åü „Åã	Doko kara kimashita ka	D'o√π venez-vous ?
„Éï „É© „É≥ „Çπ „Åã „Çâ „Åç „Åæ „Åó „Åü	Furansu kara kimashita	Je viens de France.
„ÅÑ „Åæ „Å™„Çì „Åò „Åß „Åô „Åã	Ima nanji desu ka	Quelle heure est-il ?
„Åó „Åî „Å® „ÅØ „Å™ „Çì „Åß „Åô „Åã	Shigoto wa nan desu ka	Quel est votre m√©tier ?
„Åó „ÇÖ „Åµ „Åß „Åô	Shufu desu	Je suis femme/homme au foyer.
„Åã „ÅÑ „Åó „ÇÉ „ÅÑ „Çì „Åß „Åô	Kaishain desu	Je suis employ√©(e) de bureau.
„Åô „Å∞ „Çâ „Åó „ÅÑ „Åß „Åô	Subarashii desu	C‚Äôest merveilleux.
„Åã „Çè „ÅÑ „ÅÑ „Åß „Åô „Å≠	Kawaii desu ne	C‚Äôest mignon, n‚Äôest-ce pas ?
„Åü „ÅÆ „Åó „ÅÑ „Åß „Åô	Tanoshii desu	C‚Äôest amusant / agr√©able.
„Å≤ „Åæ „Åß „Åô	Hima desu	Je suis libre / Je n‚Äôai rien √† faire.
„ÅÑ „Åù „Åå „Åó „ÅÑ „Åß „Åô	Isogashii desu	Je suis occup√©(e).
„Å© „Çà „ÅÜ „Å≥ „Å´ „ÅÇ „ÅÑ „Åæ „Åó „Çá „ÅÜ	Doyoubi ni aimashou	Retrouvons-nous samedi.
„Åæ „Å£ „Åô „Åê „ÅÑ „Å£ „Å¶ „Åè „Å† „Åï „ÅÑ	Massugu itte kudasai	Allez tout droit s'il vous pla√Æt.
„Åø „Åé „Å´ „Åæ „Åå „Å£ „Å¶ „Åè „Å† „Åï „ÅÑ	Migi ni magatte kudasai	Tournez √† droite s‚Äôil vous pla√Æt.
„Å≤ „Å† „Çä „Å´ „Åæ „Åå „Å£ „Å¶ „Åè „Å† „Åï „ÅÑ	Hidari ni magatte kudasai	Tournez √† gauche s‚Äôil vous pla√Æt.
„Åì „ÅÆ „Åß „Çì „Åó„ÇÉ „ÅØ „Å© „Åì „Å´ „ÅÑ „Åç „Åæ „Åô „Åã	Kono densha wa doko ni ikimasu ka	O√π va ce train ?
„Äú „Å´ „ÅÑ „Åç „Åü „ÅÑ „Åß „Åô	~ ni ikitai desu	Je veux aller √† ~.`;

    function parseRawData() {
      return rawData.split('\n').map(line => {
        const [hiragana, romajiLine, frenchLine] = line.split('\t');
        const chars = hiragana.trim().split(' ');
        const romajiParts = romajiLine.trim().split(' ');
        const romajiMap = {};
        chars.forEach((char, i) => {
          if (!romajiMap[char]) romajiMap[char] = romajiParts[i] || '';
        });
        return {
          correctPhrase: chars,
          romajiMap,
          romajiLine,
          frenchLine
        };
      });
    }

    const phrases = parseRawData();
    let currentIndex = 0, boxes = [], romajiBoxes = [], clickHistory = [], hintCount = 0, hintActive = false, lastHintedBox = null;

    const phraseContainer = document.getElementById('phrase-container');
    const romajiContainer = document.getElementById('romaji-container');
    const buttonsContainer = document.getElementById('buttons');
    const instruction = document.getElementById('instruction');
    const feedback = document.getElementById('feedback');
    const hintCountSpan = document.getElementById('hintCount');
    const checkButton = document.getElementById('checkButton');
    const clickAudio = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAD//f39/f39");

    function init() { loadPhrase(currentIndex); }
    function loadPhrase(index) {
      const phrase = phrases[index];
      boxes = []; romajiBoxes = []; clickHistory = [];
      hintCount = 0; hintCountSpan.textContent = hintCount; feedback.textContent = '';
      checkButton.disabled = true;
      instruction.innerHTML = `<p><em>${phrase.romajiLine}</em></p><p><strong>${phrase.frenchLine}</strong></p>`;
      phraseContainer.style.gridTemplateColumns = `repeat(${phrase.correctPhrase.length}, 40px)`;
      romajiContainer.style.gridTemplateColumns = `repeat(${phrase.correctPhrase.length}, 40px)`;
      phraseContainer.innerHTML = ''; romajiContainer.innerHTML = ''; buttonsContainer.innerHTML = '';

      for (let i = 0; i < phrase.correctPhrase.length; i++) {
        const rBox = document.createElement('div'); rBox.className = 'romaji-box'; rBox.textContent = ''; romajiContainer.appendChild(rBox); romajiBoxes.push(rBox);
        const box = document.createElement('div'); box.className = 'box'; box.textContent = ''; phraseContainer.appendChild(box); boxes.push(box);
      }

      const hiraganaOptions = phrase.correctPhrase.slice().sort(() => Math.random() - 0.5);
      hiraganaOptions.forEach(char => {
        const btn = document.createElement('button');
        btn.textContent = char;
        btn.onclick = () => { clickAudio.play(); insertCharacter(char, btn); };
        buttonsContainer.appendChild(btn);
      });
    }

    function insertCharacter(char, button) {
      const emptyBox = boxes.find(b => b.textContent === '');
      if (emptyBox) {
        emptyBox.textContent = char;
        button.disabled = true;
        clickHistory.push({box: emptyBox, button});
        updateCheckButtonState();
      }
    }

    function updateCheckButtonState() {
      checkButton.disabled = !boxes.every(b => b.textContent !== '');
    }

    function checkAnswer() {
      const phrase = phrases[currentIndex];
      boxes.forEach((box, i) => {
        box.classList.remove('correct', 'incorrect');
        if (box.textContent === phrase.correctPhrase[i]) {
          box.classList.add('correct');
          romajiBoxes[i].textContent = phrase.romajiMap[box.textContent] || '';
        } else {
          box.classList.add('incorrect');
          romajiBoxes[i].textContent = '';
        }
      });
      const result = boxes.map(b => b.textContent).join('') === phrase.correctPhrase.join('');
      feedback.textContent = result ? '‚úÖ Bravo !' : '‚ùå Essaie encore';
    }

    function clearBoxes() {
      boxes.forEach((box, i) => {
        box.textContent = '';
        box.classList.remove('correct', 'incorrect');
        romajiBoxes[i].textContent = '';
      });
      document.querySelectorAll('#buttons button').forEach(b => b.disabled = false);
      clickHistory = []; feedback.textContent = ''; updateCheckButtonState();
    }

    function undoLast() {
      const last = clickHistory.pop();
      if (last) {
        const idx = boxes.indexOf(last.box);
        last.box.textContent = '';
        romajiBoxes[idx].textContent = '';
        last.box.classList.remove('correct', 'incorrect');
        last.button.disabled = false;
        updateCheckButtonState();
      }
    }

    function showHint() {
      const phrase = phrases[currentIndex];
      const i = boxes.findIndex(b => b.textContent === '');
      if (i !== -1) {
        lastHintedBox = boxes[i];
        lastHintedBox.textContent = phrase.correctPhrase[i];
        lastHintedBox.style.opacity = '0.5';
        hintCount++;
        hintCountSpan.textContent = hintCount;
        hintActive = true;
      }
    }

    function hideHint() {
      if (hintActive && lastHintedBox) {
        lastHintedBox.textContent = '';
        lastHintedBox.style.opacity = '1';
        lastHintedBox = null;
        hintActive = false;
      }
    }

    function nextPhrase() {
      currentIndex = (currentIndex + 1) % phrases.length;
      loadPhrase(currentIndex);
    }

    window.onload = init;
  </script>
</body>
</html>
